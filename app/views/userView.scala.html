@(id: Int)(implicit session: play.api.mvc.Session, flash: play.api.mvc.Flash)

@import helper._
@implicitFieldConstructor = @{ FieldConstructor(bootstrapForm.render)}


@user = @{UserM.getUser(id)}
@teams = @{UserTeamMap.getTeams(id)}
@allTeams = @{TeamM.getTeams}



@template("User"){
	


	<!-- Store ID for javascript -->
	<div id="user_id" value="@id"></div>
	@user match {
		case Some(u) => {
			<div class = "row">
			<h1>User: @{u.first_name + " " + u.last_name}</h1>


			<table class ="table table-striped">
				<tbody>
					<tr><td>ID<td/><td>@id<td/></tr>
					<tr><td>First name<td/><td> @u.first_name<td/></tr>
					<tr><td>Last name<td/><td> @u.last_name<td/></tr>
					<tr><td>Email<td/><td> @u.email<td/></tr>
				</tbody>
			</table>
			</div>

			@if(!u.deleted){

			<div class = "row">
				@form(action = routes.UserInfo.editUser(id)){
					<button class ="btn btn-info" type="submit">Edit User</button>

				}
				@form(action = routes.UserInfo.deleteUser(id)){
					<button class ="btn btn-danger" type="submit">Delete User</button>

				}
			</div>

			<div class = "row">
				<h3>Teams</h3>

				<ul>
					@for(team <- teams ){
						<li><a class="remove" value="@team.id.get"><i class="icon-remove"></i></a>  <a href="@routes.TeamInfo.teamPage(team.id.get)">@{team.name}</a></li>
					}
				</ul>
			</div>


			<div class ="row">
				<!-- Use javascript to "submit" form -->


				<form>   
					<fieldset>				
					<select id="team_select">
						@for(team <- allTeams if(!team.deleted)){
							<option value="@team.id.get">@team.name</option>
						}
					</select>
					<!-- <a id="add_team" class="btn btn-primary">Add Team</a> -->
					</fieldset>
					<a id="add_team" class="btn btn-primary">Add Team</a>
				</form>

			</div>

			<div class = "row">
				<h3>Incidents</h3>

				<h4>Primary Responder For</h4>
				<ul>
					@for(i <- UserM.getPrimaryResponderIncidents(id)){
						<li><a href="@routes.IncidentView.incidentView(i.id.get)">@{i.title}</a></li>
					}
				</ul>

				<h4>Team Responder For</h4>
				<ul>
					@for(i <- UserM.getResponseTeamIncidents(id)){
						<li><a href="@routes.IncidentView.incidentView(i.id.get)">@{i.title}</a></li>
					}
				</ul>

				<h4>Subscribed To</h4>
				<ul>
					@for(i <- UserM.getSubscriptions(id)){
						<li><a href="@routes.IncidentView.incidentView(i.id.get)">@{i.title}</a></li>
					}
				</ul>


			</div>



			}else{
				<h1 class="text-error">User has been deleted</h1>
			}

		}
		case None => {
			<h1 class ="text-error">User Not Found</h1>
		}	
	}




	<script src="@routes.Assets.at("javascripts/userView.js")" type="text/javascript"></script>
	

}